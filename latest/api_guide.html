

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>API Guide &mdash; Streamlink 1.7.0+87.g12ad1c7 documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  
  
    

  

  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="Streamlink 1.7.0+87.g12ad1c7 documentation" href="index.html"/>
        <link rel="next" title="API Reference" href="api.html"/>
        <link rel="prev" title="Developing" href="developing.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document" data-spy="scroll" data-target=".wy-menu-vertical > ul > li.current > ul">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-header">
        <a href="index.html"> Streamlink</a>
        
        <div class="tablet-hide">
          <small>Command-line utility that extracts streams from various services and pipes them into a video player of choice.</small>
          <hr />
        </div>
        

        <div class="wy-side-nav-versions" role="note" aria-label="versions">
  <span class="wy-side-nav-versions-current"><i class="fa fa-book"></i>1.7.0+87.g12ad1c7</span>
  <dl class="wy-side-nav-versions-others">
    <dd><a href="/" class="">Stable</a></dd>
    <dd><a href="/latest/" class="version-current">Latest</a></dd>
  </dl>
</div>
        <div class="wy-side-nav-search" role="search">
  <form id ="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
        
            <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="install.html#windows">Windows</a></li>
<li class="toctree-l2"><a class="reference internal" href="install.html#macos">macOS</a></li>
<li class="toctree-l2"><a class="reference internal" href="install.html#linux-and-bsd">Linux and BSD</a></li>
<li class="toctree-l2"><a class="reference internal" href="install.html#package-maintainers">Package maintainers</a></li>
<li class="toctree-l2"><a class="reference internal" href="install.html#pypi-package-and-source-code">PyPI package and source code</a></li>
<li class="toctree-l2"><a class="reference internal" href="install.html#windows-binaries">Windows binaries</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="cli.html">Command-Line Interface</a><ul>
<li class="toctree-l2"><a class="reference internal" href="cli.html#tutorial">Tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="cli.html#configuration-file">Configuration file</a></li>
<li class="toctree-l2"><a class="reference internal" href="cli.html#plugin-specific-configuration-file">Plugin specific configuration file</a></li>
<li class="toctree-l2"><a class="reference internal" href="cli.html#plugin-specific-usage">Plugin specific usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="cli.html#sideloading-plugins">Sideloading plugins</a></li>
<li class="toctree-l2"><a class="reference internal" href="cli.html#playing-built-in-streaming-protocols-directly">Playing built-in streaming protocols directly</a></li>
<li class="toctree-l2"><a class="reference internal" href="cli.html#proxy-support">Proxy Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="cli.html#command-line-usage">Command-line usage</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="plugin_matrix.html">Plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="players.html">Players</a><ul>
<li class="toctree-l2"><a class="reference internal" href="players.html#transport-modes">Transport modes</a></li>
<li class="toctree-l2"><a class="reference internal" href="players.html#player-compatibility">Player compatibility</a></li>
<li class="toctree-l2"><a class="reference internal" href="players.html#known-issues-and-workarounds">Known issues and workarounds</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="issues.html">Common issues</a><ul>
<li class="toctree-l2"><a class="reference internal" href="issues.html#streams-are-buffering-lagging">Streams are buffering/lagging</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="developing.html">Developing</a><ul>
<li class="toctree-l2"><a class="reference internal" href="developing.html#setup">Setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="developing.html#validating-changes">Validating changes</a></li>
<li class="toctree-l2"><a class="reference internal" href="developing.html#plugins">Plugins</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">API Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#extracting-streams">Extracting streams</a></li>
<li class="toctree-l2"><a class="reference internal" href="#opening-streams-to-read-data">Opening streams to read data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#inspecting-streams">Inspecting streams</a></li>
<li class="toctree-l2"><a class="reference internal" href="#session-object">Session object</a></li>
<li class="toctree-l2"><a class="reference internal" href="#examples">Examples</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="api.html#streamlink">Streamlink</a></li>
<li class="toctree-l2"><a class="reference internal" href="api.html#session">Session</a></li>
<li class="toctree-l2"><a class="reference internal" href="api.html#module-streamlink.plugin">Plugins</a></li>
<li class="toctree-l2"><a class="reference internal" href="api.html#streams">Streams</a></li>
<li class="toctree-l2"><a class="reference internal" href="api.html#exceptions">Exceptions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Changelog</a><ul>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#streamlink-1-7-0-2020-10-18">streamlink 1.7.0 (2020-10-18)</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#streamlink-1-6-0-2020-09-22">streamlink 1.6.0 (2020-09-22)</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#streamlink-1-5-0-2020-07-07">streamlink 1.5.0 (2020-07-07)</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#streamlink-1-4-1-2020-04-24">streamlink 1.4.1 (2020-04-24)</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#streamlink-1-4-0-2020-04-22">streamlink 1.4.0 (2020-04-22)</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#streamlink-1-3-1-2020-01-27">streamlink 1.3.1 (2020-01-27)</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#streamlink-1-3-0-2019-11-22">streamlink 1.3.0 (2019-11-22)</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#streamlink-1-2-0-2019-08-18">streamlink 1.2.0 (2019-08-18)</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#streamlink-1-1-1-2019-04-02">streamlink 1.1.1 (2019-04-02)</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#streamlink-1-1-0-2019-03-31">streamlink 1.1.0 (2019-03-31)</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#streamlink-1-0-0-2019-01-30">streamlink 1.0.0 (2019-01-30)</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#streamlink-0-14-2-2018-06-28">streamlink 0.14.2 (2018-06-28)</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#streamlink-0-14-0-2018-06-26">streamlink 0.14.0 (2018-06-26)</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#streamlink-0-13-0-2018-06-06">streamlink 0.13.0 (2018-06-06)</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#streamlink-0-12-1-2018-05-07">streamlink 0.12.1 (2018-05-07)</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#streamlink-0-12-0-2018-05-07">streamlink 0.12.0 (2018-05-07)</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#streamlink-0-11-0-2018-03-08">streamlink 0.11.0 (2018-03-08)</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#streamlink-0-10-0-2018-01-23">streamlink 0.10.0 (2018-01-23)</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#streamlink-0-9-0-2017-11-14">streamlink 0.9.0 (2017-11-14)</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#streamlink-0-8-1-2017-09-12">Streamlink 0.8.1 (2017-09-12)</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#streamlink-0-7-0-2017-06-30">streamlink 0.7.0 (2017-06-30)</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#streamlink-0-6-0-2017-05-11">streamlink 0.6.0 (2017-05-11)</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#streamlink-0-5-0-2017-04-04">streamlink 0.5.0 (2017-04-04)</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#streamlink-0-4-0-2017-03-09">streamlink 0.4.0 (2017-03-09)</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#streamlink-0-3-2-2017-02-10">streamlink 0.3.2 (2017-02-10)</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#streamlink-0-3-1-2017-02-03">streamlink 0.3.1 (2017-02-03)</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#streamlink-0-3-0-2017-01-24">streamlink 0.3.0 (2017-01-24)</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#streamlink-0-2-0-2016-12-16">streamlink 0.2.0 (2016-12-16)</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#streamlink-0-1-0-2016-11-21">streamlink 0.1.0 (2016-11-21)</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#streamlink-0-0-2-2016-10-12">streamlink 0.0.2 (2016-10-12)</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#streamlink-0-0-1-2016-09-23">streamlink 0.0.1 (2016-09-23)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="donate.html">Donating</a><ul>
<li class="toctree-l2"><a class="reference internal" href="donate.html#bastimeyer">Bastimeyer</a></li>
<li class="toctree-l2"><a class="reference internal" href="donate.html#beardypig">Beardypig</a></li>
<li class="toctree-l2"><a class="reference internal" href="donate.html#gravyboat">Gravyboat</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="applications.html">Streamlink Applications</a><ul>
<li class="toctree-l2"><a class="reference internal" href="applications.html#streamlink-twitch-gui">Streamlink Twitch GUI</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="thirdparty.html">Third Party Applications</a><ul>
<li class="toctree-l2"><a class="reference internal" href="thirdparty.html#liveproxy">LiveProxy</a></li>
<li class="toctree-l2"><a class="reference internal" href="thirdparty.html#wtwitch">Wtwitch</a></li>
<li class="toctree-l2"><a class="reference internal" href="thirdparty.html#obs-streamlink">OBS-Streamlink</a></li>
</ul>
</li>
</ul>

        
      </div>


      
      <div class="tablet-hide">
        <hr />
		<p class="wy-text-center">
	        <a href="https://github.com/streamlink/streamlink"
			   class="github-button" data-icon="octicon-mark-github"
		       data-count-href="/streamlink/streamlink/stargazers"
			   data-count-api="/repos/streamlink/streamlink#stargazers_count">Github</a>
	        <a href="https://github.com/streamlink/streamlink/issues"
			   class="github-button" data-icon="octicon-issue-opened">Issues</a>

        </p>
      </div>
      
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">Streamlink</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>API Guide</li>
      <li class="wy-breadcrumbs-aside">
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            
            <div class="admonition version-warning">
              <p class="admonition-title">You are reading the documentation for the in-development version of Streamlink.</p>
            </div>
            
            
  <div class="section" id="api-guide">
<h1>API Guide<a class="headerlink" href="#api-guide" title="Permalink to this headline">¶</a></h1>
<p>This API is what powers the <a class="reference internal" href="cli.html#command-line-interface"><span class="std std-ref">cli</span></a> but is also available to developers that wish
to make use of the data Streamlink can retrieve in their own application.</p>
<div class="section" id="extracting-streams">
<h2>Extracting streams<a class="headerlink" href="#extracting-streams" title="Permalink to this headline">¶</a></h2>
<p>The simplest use of the Streamlink API looks like this:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">streamlink</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">streams</span> <span class="o">=</span> <span class="n">streamlink</span><span class="o">.</span><span class="n">streams</span><span class="p">(</span><span class="s2">&quot;https://twitch.tv/day9tv&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>This simply attempts to find a plugin and use it to extract streams from
the URL. This works great in simple cases but if you want more
fine tuning you need to use a <a class="reference internal" href="#session-object">session object</a> instead.</p>
<p>The returned value is a dict containing <code class="xref py py-class docutils literal"><span class="pre">Stream</span></code> objects:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">streams</span>
<span class="go">{&#39;best&#39;: &lt;HLSStream(&#39;https://video11.fra01.hls.twitch.tv/ ...&#39;)&gt;,</span>
<span class="go"> &#39;high&#39;: &lt;HLSStream(&#39;https://video11.fra01.hls.twitch.tv/ ...&#39;)&gt;,</span>
<span class="go"> &#39;low&#39;: &lt;HLSStream(&#39;https://video11.fra01.hls.twitch.tv/ ...&#39;)&gt;,</span>
<span class="go"> &#39;medium&#39;: &lt;HLSStream(&#39;https://video11.fra01.hls.twitch.tv/ ...&#39;)&gt;,</span>
<span class="go"> &#39;mobile&#39;: &lt;HLSStream(&#39;https://video11.fra01.hls.twitch.tv/ ...&#39;)&gt;,</span>
<span class="go"> &#39;source&#39;: &lt;HLSStream(&#39;https://video11.fra01.hls.twitch.tv/ ...&#39;)&gt;,</span>
<span class="go"> &#39;worst&#39;: &lt;HLSStream(&#39;https://video11.fra01.hls.twitch.tv/ ...&#39;)&gt;}</span>
</pre></div>
</div>
<p>If no plugin for the URL is found, a <code class="xref py py-exc docutils literal"><span class="pre">NoPluginError</span></code> will be raised.
If an error occurs while fetching streams, a <code class="xref py py-exc docutils literal"><span class="pre">PluginError</span></code> will be raised.</p>
</div>
<div class="section" id="opening-streams-to-read-data">
<h2>Opening streams to read data<a class="headerlink" href="#opening-streams-to-read-data" title="Permalink to this headline">¶</a></h2>
<p>Now that you have extracted some streams we might want to read some data from
one of them. When you call <cite>open()</cite> on a stream, a file-like object will be
returned, which you can call <cite>.read(size)</cite> and <cite>.close()</cite> on.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">stream</span> <span class="o">=</span> <span class="n">streams</span><span class="p">[</span><span class="s2">&quot;source&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fd</span> <span class="o">=</span> <span class="n">stream</span><span class="o">.</span><span class="n">open</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">fd</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fd</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>If an error occurs while opening a stream, a <code class="xref py py-exc docutils literal"><span class="pre">StreamError</span></code> will be raised.</p>
</div>
<div class="section" id="inspecting-streams">
<h2>Inspecting streams<a class="headerlink" href="#inspecting-streams" title="Permalink to this headline">¶</a></h2>
<p>It's also possible to inspect streams internal parameters, go to
<a class="reference internal" href="api.html#stream-subclasses"><span class="std std-ref">Stream subclasses</span></a> to see what attributes are available
for inspection for each stream type.</p>
<p>For example this is a <code class="xref py py-class docutils literal"><span class="pre">HLSStream</span></code> object which
contains a <cite>url</cite> attribute.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">stream</span><span class="o">.</span><span class="n">url</span>
<span class="go">&#39;https://video38.ams01.hls.twitch.tv/hls11/ ...&#39;</span>
</pre></div>
</div>
</div>
<div class="section" id="session-object">
<h2>Session object<a class="headerlink" href="#session-object" title="Permalink to this headline">¶</a></h2>
<p>The session allows you to set various options and is more efficient
when extracting streams more than once. You start by creating a
<code class="xref py py-class docutils literal"><span class="pre">Streamlink</span></code> object:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">streamlink</span> <span class="kn">import</span> <span class="n">Streamlink</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">session</span> <span class="o">=</span> <span class="n">Streamlink</span><span class="p">()</span>
</pre></div>
</div>
<p>You can then extract streams like this:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">streams</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">streams</span><span class="p">(</span><span class="s2">&quot;https://twitch.tv/day9tv&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>or set options like this:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">session</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s2">&quot;rtmp-rtmpdump&quot;</span><span class="p">,</span> <span class="s2">&quot;/path/to/rtmpdump&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>See <code class="xref py py-func docutils literal"><span class="pre">Streamlink.set_option()</span></code> to see which options are available.</p>
</div>
<div class="section" id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h2>
<div class="section" id="simple-player">
<h3>Simple player<a class="headerlink" href="#simple-player" title="Permalink to this headline">¶</a></h3>
<p>This example uses the <a class="reference external" href="https://wiki.gnome.org/action/show/Projects/PyGObject">PyGObject</a> module to playback a stream using the
<a class="reference external" href="https://gstreamer.freedesktop.org/">GStreamer</a> framework.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env python</span>

<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span>

<span class="kn">import</span> <span class="nn">sys</span>

<span class="kn">import</span> <span class="nn">gi</span>

<span class="kn">from</span> <span class="nn">gi.repository</span> <span class="kn">import</span> <span class="n">GObject</span> <span class="k">as</span> <span class="n">gobject</span><span class="p">,</span> <span class="n">Gst</span> <span class="k">as</span> <span class="n">gst</span>
<span class="kn">from</span> <span class="nn">streamlink</span> <span class="kn">import</span> <span class="n">Streamlink</span><span class="p">,</span> <span class="n">StreamError</span><span class="p">,</span> <span class="n">PluginError</span><span class="p">,</span> <span class="n">NoPluginError</span>


<span class="k">def</span> <span class="nf">exit</span><span class="p">(</span><span class="n">msg</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>


<span class="k">class</span> <span class="nc">StreamlinkPlayer</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fd</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mainloop</span> <span class="o">=</span> <span class="n">gobject</span><span class="o">.</span><span class="n">MainLoop</span><span class="p">()</span>

        <span class="c1"># This creates a playbin pipeline and using the appsrc source</span>
        <span class="c1"># we can feed it our stream data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pipeline</span> <span class="o">=</span> <span class="n">gst</span><span class="o">.</span><span class="n">ElementFactory</span><span class="o">.</span><span class="n">make</span><span class="p">(</span><span class="s2">&quot;playbin&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pipeline</span><span class="o">.</span><span class="n">set_property</span><span class="p">(</span><span class="s2">&quot;uri&quot;</span><span class="p">,</span> <span class="s2">&quot;appsrc://&quot;</span><span class="p">)</span>

        <span class="c1"># When the playbin creates the appsrc source it will call</span>
        <span class="c1"># this callback and allow us to configure it</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pipeline</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;source-setup&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_source_setup</span><span class="p">)</span>

        <span class="c1"># Creates a bus and set callbacks to receive errors</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bus</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pipeline</span><span class="o">.</span><span class="n">get_bus</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bus</span><span class="o">.</span><span class="n">add_signal_watch</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bus</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;message::eos&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_eos</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bus</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;message::error&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_error</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">exit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
        <span class="n">exit</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">stop</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Stop playback and exit mainloop</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pipeline</span><span class="o">.</span><span class="n">set_state</span><span class="p">(</span><span class="n">gst</span><span class="o">.</span><span class="n">State</span><span class="o">.</span><span class="n">NULL</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mainloop</span><span class="o">.</span><span class="n">quit</span><span class="p">()</span>

        <span class="c1"># Close the stream</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fd</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fd</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">play</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stream</span><span class="p">):</span>
        <span class="c1"># Attempt to open the stream</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fd</span> <span class="o">=</span> <span class="n">stream</span><span class="o">.</span><span class="n">open</span><span class="p">()</span>
        <span class="k">except</span> <span class="n">StreamError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="s2">&quot;Failed to open stream: </span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>

        <span class="c1"># Start playback</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pipeline</span><span class="o">.</span><span class="n">set_state</span><span class="p">(</span><span class="n">gst</span><span class="o">.</span><span class="n">State</span><span class="o">.</span><span class="n">PLAYING</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mainloop</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">on_source_setup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">element</span><span class="p">,</span> <span class="n">source</span><span class="p">):</span>
        <span class="c1"># When this callback is called the appsrc expects</span>
        <span class="c1"># us to feed it more data</span>
        <span class="n">source</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;need-data&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_source_need_data</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">on_source_need_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">length</span><span class="p">):</span>
        <span class="c1"># Attempt to read data from the stream</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fd</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">length</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">IOError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="s2">&quot;Failed to read data from stream: </span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>

        <span class="c1"># If data is empty it&#39;s the end of stream</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">data</span><span class="p">:</span>
            <span class="n">source</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="s2">&quot;end-of-stream&quot;</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="c1"># Convert the Python bytes into a GStreamer Buffer</span>
        <span class="c1"># and then push it to the appsrc</span>
        <span class="n">buf</span> <span class="o">=</span> <span class="n">gst</span><span class="o">.</span><span class="n">Buffer</span><span class="o">.</span><span class="n">new_wrapped</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">source</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="s2">&quot;push-buffer&quot;</span><span class="p">,</span> <span class="n">buf</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">on_eos</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bus</span><span class="p">,</span> <span class="n">msg</span><span class="p">):</span>
        <span class="c1"># Stop playback on end of stream</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">on_error</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bus</span><span class="p">,</span> <span class="n">msg</span><span class="p">):</span>
        <span class="c1"># Print error message and exit on error</span>
        <span class="n">error</span> <span class="o">=</span> <span class="n">msg</span><span class="o">.</span><span class="n">parse_error</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span>
        <span class="n">exit</span><span class="p">(</span><span class="s2">&quot;Usage: </span><span class="si">{0}</span><span class="s2"> &lt;url&gt; &lt;quality&gt;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>

    <span class="c1"># Initialize and check GStreamer version</span>
    <span class="n">gi</span><span class="o">.</span><span class="n">require_version</span><span class="p">(</span><span class="s2">&quot;Gst&quot;</span><span class="p">,</span> <span class="s2">&quot;1.0&quot;</span><span class="p">)</span>
    <span class="n">gobject</span><span class="o">.</span><span class="n">threads_init</span><span class="p">()</span>
    <span class="n">gst</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>

    <span class="c1"># Collect arguments</span>
    <span class="n">url</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">quality</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

    <span class="c1"># Create the Streamlink session</span>
    <span class="n">streamlink</span> <span class="o">=</span> <span class="n">Streamlink</span><span class="p">()</span>

    <span class="c1"># Enable logging</span>
    <span class="n">streamlink</span><span class="o">.</span><span class="n">set_loglevel</span><span class="p">(</span><span class="s2">&quot;info&quot;</span><span class="p">)</span>
    <span class="n">streamlink</span><span class="o">.</span><span class="n">set_logoutput</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">)</span>

    <span class="c1"># Attempt to fetch streams</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">streams</span> <span class="o">=</span> <span class="n">streamlink</span><span class="o">.</span><span class="n">streams</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">NoPluginError</span><span class="p">:</span>
        <span class="n">exit</span><span class="p">(</span><span class="s2">&quot;Streamlink is unable to handle the URL &#39;</span><span class="si">{0}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">url</span><span class="p">))</span>
    <span class="k">except</span> <span class="n">PluginError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
        <span class="n">exit</span><span class="p">(</span><span class="s2">&quot;Plugin error: </span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">streams</span><span class="p">:</span>
        <span class="n">exit</span><span class="p">(</span><span class="s2">&quot;No streams found on URL &#39;</span><span class="si">{0}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">url</span><span class="p">))</span>

    <span class="c1"># Look for specified stream</span>
    <span class="k">if</span> <span class="n">quality</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">streams</span><span class="p">:</span>
        <span class="n">exit</span><span class="p">(</span><span class="s2">&quot;Unable to find &#39;</span><span class="si">{0}</span><span class="s2">&#39; stream on URL &#39;</span><span class="si">{1}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">quality</span><span class="p">,</span> <span class="n">url</span><span class="p">))</span>

    <span class="c1"># We found the stream</span>
    <span class="n">stream</span> <span class="o">=</span> <span class="n">streams</span><span class="p">[</span><span class="n">quality</span><span class="p">]</span>

    <span class="c1"># Create the player and start playback</span>
    <span class="n">player</span> <span class="o">=</span> <span class="n">StreamlinkPlayer</span><span class="p">()</span>

    <span class="c1"># Blocks until playback is done</span>
    <span class="n">player</span><span class="o">.</span><span class="n">play</span><span class="p">(</span><span class="n">stream</span><span class="p">)</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="api.html" class="btn btn-neutral float-right" title="API Reference">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="developing.html" class="btn btn-neutral" title="Developing"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Streamlink.
    </p>
  </div>

  <a href="https://github.com/chrippa/sphinx_rtd_theme_violet">Sphinx theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>
</footer>
        </div>
      </div>

    </section>

  </div>

  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1.7.0+87.g12ad1c7',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
  <script type="text/javascript" src="_static/js/theme.js"></script>
  
  <script type="text/javascript" src="_static/js/scrollspy.js"></script>

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
  


  
  <script async defer id="github-bjs" src="https://buttons.github.io/buttons.js"></script>
   

</body>
</html>